maintainers:
  - github: taotieren
    email: admin@taotieren.com
# build_prefix: aur-repo-x86_64
pre_build_script: |
  aur_pre_build(maintainers=['envolution'])
  add_makedepends(['git'])

  run_cmd(['sed', '-i', "s/make/sed -i 's!libexec/mecab!lib/mecab!g' config.status make/", 'PKGBUILD'])

  with open('PKGBUILD', 'r') as f:
    pkgbuild_content = f.read()

  old_build_section = """build() {
cd "$pkgname/$pkgname"
make
}"""
  new_build_section = """build() {
cd "$pkgname/$pkgname"
sed -i 's!libexec/mecab!lib/mecab!g' config.status
make
}"""

  pkgbuild_content = pkgbuild_content.replace(old_build_section, new_build_section)

  with open('PKGBUILD', 'w') as f:
      f.write(pkgbuild_content)

  run_cmd(['updpkgsums'])
post_build: aur_post_build
repo_depends:
  - mecab-git
update_on:
  - source: aur
    aur: mecab-ipadic
