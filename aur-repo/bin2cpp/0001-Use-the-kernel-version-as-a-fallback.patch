From 02bec9087f346648aa2c5e1e778caa67588e5a7e Mon Sep 17 00:00:00 2001
From: taotieren <admin@taotieren.com>
Date: Wed, 27 Aug 2025 14:10:24 +0800
Subject: [PATCH] Use the kernel version as a fallback

---
 CMakeLists.txt | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index edcf920..c347185 100755
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -82,8 +82,15 @@ elseif (UNIX)
   # Get Linux distribution info.
   GetOsReleaseInfo(LINUX_DIST_NAME LINUX_DIST_VER )
 
+  if("${LINUX_DIST_VER}" STREQUAL "")
+    # Use the kernel version as a fallback
+    execute_process(COMMAND uname -r
+      OUTPUT_VARIABLE LINUX_DIST_VER
+      OUTPUT_STRIP_TRAILING_WHITESPACE)
+  endif()
+
   # Extract distribution MAJOR version
-  get_major_version(${LINUX_DIST_VER} LINUX_DIST_VER_MAJOR)
+  get_major_version("${LINUX_DIST_VER}" LINUX_DIST_VER_MAJOR)
 
   MESSAGE( STATUS "LINUX_DIST_NAME:             " ${LINUX_DIST_NAME} )
   MESSAGE( STATUS "LINUX_DIST_VER:              " ${LINUX_DIST_VER} )
-- 
2.51.0

